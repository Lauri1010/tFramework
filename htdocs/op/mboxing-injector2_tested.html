<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Title of the document</title>
<script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
</head>
<body>
	<div id="op-main-container">main container
<div class="Stabilizer">&nbsp;
<br/>
</div>
<div class="JatkoLinkki">&nbsp; <!-- // Olisko tämä hyvä mbox . Last stablilizer. -->
</div>
<br/>
</div>
	</div>
</body>
<script>
// TODO: Optimize this for performance? 
// TODO: check if mbox library has been loaded?
if (typeof jQuery != 'undefined') {

		checkMboxing();
		
		function checkMboxing(){
		
			// Get from satellite  .. liferay page name
		    // var pageName = _satellite.getVar('Custom Page Name');   
		
			var pageName='ha:tun:paivittaiset:tilit:avaa-kasvutuotto:valmis';
		
			// Better to split this 
			var pageArray = pageName.split(':'); 
			
			// Has the 'valmis' been found? If not, then there is something wrong. 
			var vf=false;
			var mboxing='';
			
			for (i = 0; i < pageArray.length; i++) { 

				var pe=pageArray[i];
			
				if(pe=='avaa-kayttotili'){
					mboxing+='Kayttotili';
				}
				
				if(pe=='avaa-tavoitetili'){
					mboxing+='Tavoitetili';
				}
				
				if(pe=='avaa-maaraaikainen-tuottotili'){
					mboxing+='MTuottotili';
				}
				
				if(pe=='avaa-kasvutuotto'){
					mboxing+='Kasvutuotto';
				}
			
				// Slide 10
				if(pe=='kulutusluottohakemus'){
					mboxing+='Kulutusluottohakemus';
				
				}
				// Slide 14
				if(pe=='hae-opintolainaa'){
					mboxing+='Hae-opintolainaa';
				
				}
				
				// Slide 15 . 
				if(pe=='arvopaperitoimeksiannot'){
					mboxing+='Arvopaperitoimeksiannot';
				
				}
				
				// Slide 16
				if(pe=='op-visa-electron'){
					mboxing+='OpVisaElectron';
				
				}
				
				// Slide 17
				if(pe=='op-visa-debit'){
					mboxing+='OpVisaDebit';
				
				}
				
				// Slide 18   Tähän tehty. 
				if(pe=='op-visa'){
					mboxing+='OpVisa';
				
				}
				
				// Slide 19
				if(pe=='op-visa-gold'){
					mboxing+='OpVisaGold';
				
				}
				
				// Slide 20
				if(pe=='op-visa-mastercard'){
					mboxing+='OpVisaMastercard';
				
				}

				if(pe=='valmis' || pe=='allekirjoitusavainluku'){
					vf=true;
				}
			}
			
			// TODO: Several page loads an issue?
			if(vf && mboxing.length > 0 && jQuery){
				// Jos loisi koodissa? Hallinta työlästä. 
	
				jQuery('#op-main-container div.JatkoLinkki').last().after(function() {
					return '<div id="TPB'+mboxing+'"></div>';
				});
				// No waiting time required here?
				
				// Checking if mbox library has been loaded
				// Other checks? Success callback .. Onko käytettävissä?
				mboxDefine('TPB'+mboxing, 'T'+mboxing);
				mboxUpdate('T'+mboxing);

			}
	}
}
</script>
</html>